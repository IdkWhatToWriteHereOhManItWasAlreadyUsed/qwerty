–ö–æ–Ω–µ—á–Ω–æ! –ï—Å–ª–∏ —Ç—ã —É–∂–µ **—Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª `.sys`-—Ñ–∞–π–ª –¥—Ä–∞–π–≤–µ—Ä–∞ –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É (–í–ú) –≤ VirtualBox**, –∏ —Ö–æ—á–µ—à—å **–ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –µ–≥–æ –±–µ–∑ —Å–ª–æ–∂–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫**, –≤–æ—Ç –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è ‚Äî **–º–∏–Ω–∏–º—É–º –¥–µ–π—Å—Ç–≤–∏–π, –º–∞–∫—Å–∏–º—É–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**.

> ‚ö†Ô∏è –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç **—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –¥—Ä–∞–π–≤–µ—Ä –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è** (—Ç.–µ. —ç—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π/–ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä, –∫–∞–∫ –≤ —Ç–≤–æ—ë–º —Å–ª—É—á–∞–µ).

---

## üìå –£—Å–ª–æ–≤–∏—è
1. –£ —Ç–µ–±—è –µ—Å—Ç—å:
   - `MyDriver.sys` ‚Äî —Å–∞–º –¥—Ä–∞–π–≤–µ—Ä
   - `MyDriver.inf` ‚Äî —Ñ–∞–π–ª —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
2. –ù–∞ –í–ú –≤–∫–ª—é—á—ë–Ω **Test Signing Mode**:
   ```cmd
   bcdedit /set testsigning on
   ```
   ‚Üí **–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏ –í–ú** –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ.
3. –¢—ã –≤–æ—à—ë–ª –≤ —Å–∏—Å—Ç–µ–º—É **–æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**.

---

## ‚úÖ –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤—å `.inf` —Ñ–∞–π–ª (–µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç)

–ï—Å–ª–∏ —É —Ç–µ–±—è **—Ç–æ–ª—å–∫–æ `.sys`**, –Ω–æ –Ω–µ—Ç `.inf` ‚Äî —Å–æ–∑–¥–∞–π –ø—Ä–æ—Å—Ç–æ–π `.inf` —Ä—è–¥–æ–º —Å –Ω–∏–º.

–ü—Ä–∏–º–µ—Ä `MyDriver.inf`:

```ini
[Version]
Signature="$WINDOWS NT$"
Class=System
ClassGuid={4d36e97d-e325-11ce-bfc1-08002be10318}
Provider=%ManufacturerName%
DriverVer=10/23/2025,1.0.0.0

[Manufacturer]
%ManufacturerName%=Standard,NT$ARCH$

[Standard.NT$ARCH$]
%DeviceName%=MyDriver_Install, Root\MyDriver

[MyDriver_Install]
CopyFiles=DriverFiles

[MyDriver_Install.Services]
AddService=MyDriver,2,MyDriver_Service_Inst

[MyDriver_Service_Inst]
ServiceType=1               ; KERNEL_DRIVER
StartType=3                 ; DEMAND_START (–∑–∞–ø—É—Å–∫ –≤—Ä—É—á–Ω—É—é)
ErrorControl=1              ; NORMAL
ServiceBinary=%12%\MyDriver.sys
DisplayName=%ServiceName%

[DriverFiles]
MyDriver.sys

[Strings]
ManufacturerName="MyLab"
DeviceName="My Virtual Driver"
ServiceName="MyDriver"
```

–°–æ—Ö—Ä–∞–Ω–∏ –∫–∞–∫ `MyDriver.inf` –≤ —Ç–æ–π –∂–µ –ø–∞–ø–∫–µ, —á—Ç–æ –∏ `MyDriver.sys`.

---

## ‚úÖ –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∏ –¥—Ä–∞–π–≤–µ—Ä —á–µ—Ä–µ–∑ `pnputil`

–û—Ç–∫—Ä–æ–π **–ö–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –æ—Ç –∏–º–µ–Ω–∏ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞** –Ω–∞ –í–ú:

```cmd
cd C:\–ø—É—Ç—å\–∫\–ø–∞–ø–∫–µ\—Å\–¥—Ä–∞–π–≤–µ—Ä–æ–º
pnputil /add-driver MyDriver.inf /install
```

‚úÖ –ï—Å–ª–∏ –≤—Å—ë —Ö–æ—Ä–æ—à–æ ‚Äî —É–≤–∏–¥–∏—à—å:
```
Driver package added successfully.
Published Name: oemXX.inf
```

> üí° `pnputil` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–æ–ø–∏—Ä—É–µ—Ç `.sys` –≤ `C:\Windows\System32\drivers\`.

---

## ‚úÖ –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏ –¥—Ä–∞–π–≤–µ—Ä –∫–∞–∫ —Å–ª—É–∂–±—É

–î—Ä–∞–π–≤–µ—Ä—ã —Ä–µ–∂–∏–º–∞ —è–¥—Ä–∞ –≤ Windows —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ **–¥–∏—Å–ø–µ—Ç—á–µ—Ä —Å–ª—É–∂–±**.

–í—ã–ø–æ–ª–Ω–∏:

```cmd
sc create MyDriver binPath="system32\drivers\MyDriver.sys" type=kernel
sc start MyDriver
```

> üîπ `MyDriver` ‚Äî –∏–º—è –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å `ServiceName` –≤ `.inf`.

–ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å:

```cmd
sc query MyDriver
```

–ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å **RUNNING** ‚Äî –¥—Ä–∞–π–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç!

---

## ‚úÖ –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –¥—Ä–∞–π–≤–µ—Ä "–æ–∂–∏–ª"

### –í–∞—Ä–∏–∞–Ω—Ç A: –ò—Å–ø–æ–ª—å–∑—É–π **DebugView**
1. –°–∫–∞—á–∞–π [DebugView](https://learn.microsoft.com/en-us/sysinternals/downloads/debugview)
2. –ó–∞–ø—É—Å—Ç–∏ **–æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**
3. –í–∫–ª—é—á–∏:
   - **Capture ‚Üí Kernel Output**
4. –ï—Å–ª–∏ –≤ –¥—Ä–∞–π–≤–µ—Ä–µ –µ—Å—Ç—å `DbgPrint("Hello\n");` ‚Äî —Ç—ã —ç—Ç–æ —É–≤–∏–¥–∏—à—å.

### –í–∞—Ä–∏–∞–Ω—Ç B: –ü—Ä–æ–≤–µ—Ä—å —á–µ—Ä–µ–∑ –¥–∏—Å–ø–µ—Ç—á–µ—Ä –∑–∞–¥–∞—á
- –û—Ç–∫—Ä–æ–π **–î–∏—Å–ø–µ—Ç—á–µ—Ä –∑–∞–¥–∞—á ‚Üí –°–ª—É–∂–±—ã**
- –ù–∞–π–¥–∏ `MyDriver` ‚Äî —Å—Ç–∞—Ç—É—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–†–∞–±–æ—Ç–∞–µ—Ç**

---

## üõë –ö–∞–∫ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –¥—Ä–∞–π–≤–µ—Ä

```cmd
sc stop MyDriver
sc delete MyDriver
```

> üí° –ü–æ—Å–ª–µ `sc delete` –¥—Ä–∞–π–≤–µ—Ä **–Ω–µ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ —Å–∏—Å—Ç–µ–º—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é** ‚Äî —Ç–æ–ª—å–∫–æ –∑–∞–ø–∏—Å—å —Å–ª—É–∂–±—ã.  
> –ß—Ç–æ–±—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏—Ç—å:  
> ```cmd
> pnputil /delete-driver oemXX.inf /force
> ```
> (–≥–¥–µ `oemXX.inf` ‚Äî –∏–º—è –∏–∑ —à–∞–≥–∞ 2)

---

## ‚ùó –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

| –û—à–∏–±–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|-------|--------|--------|
| `The service binary does not exist` | –ù–µ—Ç `.sys` –≤ `System32\drivers` | –£–±–µ–¥–∏—Å—å, —á—Ç–æ `pnputil` –≤—ã–ø–æ–ª–Ω–∏–ª—Å—è —É—Å–ø–µ—à–Ω–æ |
| `Access is denied` | –ù–µ –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ | –ó–∞–ø—É—Å—Ç–∏ CMD –æ—Ç –∞–¥–º–∏–Ω–∞ |
| `Test mode is not enabled` | –ù–µ –≤–∫–ª—é—á—ë–Ω Test Signing | –í—ã–ø–æ–ª–Ω–∏ `bcdedit /set testsigning on` + –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ |
| `Driver failed to load` | –û—à–∏–±–∫–∞ –≤ –∫–æ–¥–µ –¥—Ä–∞–π–≤–µ—Ä–∞ | –°–º–æ—Ç—Ä–∏ —á–µ—Ä–µ–∑ DebugView –∏–ª–∏ Event Viewer ‚Üí System |

---

## üéØ –ü—Ä–∏–º–µ—Ä: –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª

```cmd
# 1. –í–∫–ª—é—á–∏ —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (–æ–¥–∏–Ω —Ä–∞–∑)
bcdedit /set testsigning on
# ‚Üí –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏ –í–ú

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏ –¥—Ä–∞–π–≤–µ—Ä
pnputil /add-driver MyDriver.inf /install

# 3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π —Å–ª—É–∂–±—É
sc create MyDriver binPath="system32\drivers\MyDriver.sys" type=kernel

# 4. –ó–∞–ø—É—Å—Ç–∏
sc start MyDriver

# 5. –ü–æ—Å–º–æ—Ç—Ä–∏ –ª–æ–≥
# ‚Üí –∑–∞–ø—É—Å—Ç–∏ DebugView –∏ —Å–º–æ—Ç—Ä–∏ Kernel Output

# 6. –û—Å—Ç–∞–Ω–æ–≤–∏
sc stop MyDriver
sc delete MyDriver
```

---

–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å —Ç—ã –º–æ–∂–µ—à—å **–±—ã—Å—Ç—Ä–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª—é–±–æ–π `.sys`-–¥—Ä–∞–π–≤–µ—Ä** –Ω–∞ –í–ú –≤ VirtualBox.

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –º–æ–≥—É –¥–∞—Ç—å **–≥–æ—Ç–æ–≤—ã–π –∞—Ä—Ö–∏–≤ —Å —à–∞–±–ª–æ–Ω–æ–º –¥—Ä–∞–π–≤–µ—Ä–∞ + `.inf` + —Å–∫—Ä–∏–ø—Ç–æ–º –∑–∞–ø—É—Å–∫–∞**.

–£–¥–∞—á–∏! üíªüîß
